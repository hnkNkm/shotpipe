# スクショ即送信用ミニ注釈ツール 仕様書（MVP / 1枚完結型）

## 1. 目的
スクリーンショット（または画像コピー）を検知し、  
最小限の注釈（文字・矢印）を付与した上で、  
**ショートカット操作のみで即座にクリップボードへ出力**できるツールを提供する。

保存や多機能編集を前提とせず、  
**「送るためのスクショ」**に特化した高速・軽量なUXを目指す。

---

## 2. 想定ユースケース
- Windows の Snipping Tool の代替／補完
- Slack / Teams / Notion / チケット管理ツールへの即貼り付け
- 保存せず、説明用スクショを最短で作りたいケース

---

## 3. 対象プラットフォーム
- Windows 10 / 11
- macOS（Intel / Apple Silicon）

### 技術構成
- UI: Tauri
- Core: Rust

---

## 4. スコープ

### 4.1 MVPに含める機能
1. クリップボード監視（画像検知）
2. 通知による編集起動
3. 1枚完結型編集画面
4. 注釈機能
   - 文字（テキスト）
   - 矢印
   - Undo
5. アクションプリセット
   - Ctrl+1 / Ctrl+2 / Ctrl+3
   - 実行と同時にクリップボードへ出力
6. 元画像の保持（安全設計）
7. コピー完了通知
8. キャンセル（Esc）

### 4.2 MVPでは含めない機能
- 自前の画面キャプチャUI
- フォルダ監視
- モザイク／ぼかし
- レイヤー管理
- 複数画像の同時編集
- 高度な圧縮・AI処理
- 履歴ギャラリー

---

## 5. 基本ワークフロー

1. ユーザーがスクショ等で画像をクリップボードへ格納
2. 常駐プロセスが画像を検知
3. OS通知を表示  
   「画像を検知しました。編集しますか？」
4. 通知クリックで編集画面を起動
5. 編集画面で文字・矢印を追加
6. Ctrl+数字でプリセット実行
7. 変換後画像をクリップボードへ書き込み
8. 完了通知を表示し、編集画面を閉じる

### キャンセル
- Escキーで編集を破棄
- クリップボードは変更しない

---

## 6. UI仕様

### 6.1 常駐UI（トレイ/メニューバー）
- 監視 ON / OFF
- 設定
- 終了

### 6.2 通知
- 文言例：
  - 「画像を検知しました。編集しますか？」
- アクション：
  - 編集
  - 無視（または自動タイムアウト）

### 6.3 編集画面（1枚完結）
必須要素：
- 画像キャンバス
- 注釈ツール切替（文字 / 矢印）
- Undo
- ショートカットヒント表示
  - Ctrl+1: プリセット1
  - Ctrl+2: プリセット2
  - Ctrl+3: プリセット3
  - Esc: キャンセル

非表示（MVPでは出さない）：
- 保存ボタン
- コピーボタン
- タブ切替
- 詳細設定パネル

---

## 7. 注釈仕様

### 7.1 文字
- クリックで挿入
- テキスト入力
- サイズ：Small / Medium / Large（3段階）
- 色：赤（MVP固定）
- 移動：ドラッグ
- Enterで確定、Escで入力キャンセル

### 7.2 矢印
- ドラッグで始点→終点
- 太さ：標準（MVP固定）
- 色：赤

### 7.3 Undo
- 最低1段階
- 可能であれば複数段（推奨）

---

## 8. プリセット（アクションプリセット）

### 8.1 概念
プリセットは「設定の集合」ではなく、  
**押したら完了する出口（アクション）**として定義する。

### 8.2 プリセット構成（MVP最小）
- name: 表示名
- max_width: 最大長辺（0で無変更）
- format: 出力形式（PNG）
- post_action: clipboard（固定）
- close_after_copy: true

### 8.3 ショートカット
- Ctrl+1: プリセット1 → クリップボード
- Ctrl+2: プリセット2 → クリップボード
- Ctrl+3: プリセット3 → クリップボード

---

## 9. クリップボード設計

- 画像検知時点ではクリップボードを変更しない
- 編集は内部の Working Image に対して行う
- プリセット実行時のみ Output Image を生成
- Output Image をクリップボードへ書き込む
- 書き込み失敗時は元画像を保持

---

## 10. クリップボード監視仕様

### 発火条件
- クリップボードに画像データが存在する場合

### 誤発火対策
- 最小サイズフィルタ（例：64px未満は無視）
- デバウンス（1～2秒以内の同一画像は無視）

### 起動方式
- デフォルト：通知のみ
- 即編集起動は将来拡張

---

## 11. 設定（MVP）

- 監視 ON / OFF
- プリセット3件
  - name
  - max_width
- 注釈デフォルト（MVP固定可）
  - 色：赤
  - サイズ：中

---

## 12. 非機能要件

### 性能
- 検知～通知：500ms以内目標
- 編集画面起動：1秒以内目標
- フルHD～4K画像でのコピー生成：1秒以内目標

### 信頼性
- 編集開始だけでクリップボードを破壊しない
- エラー時も元画像を保持

### 操作性
- 出口はショートカットのみ
- マウス操作は注釈に限定

---

## 13. エラーハンドリング
- クリップボード取得不可：静かに無視（ログのみ）
- 書き込み不可：エラー通知＋再試行可能
- メモリ不足：編集不可通知

---

## 14. 受け入れ基準（Acceptance Criteria）
1. 画像コピーで通知が出る
2. 通知から編集画面が開く
3. 文字を追加できる
4. 矢印を追加できる
5. Escで何も変更せず閉じられる
6. Ctrl+1でコピーされる
7. コピー完了が明確に分かる
8. 編集開始だけではクリップボードが変わらない

---

## 15. 将来拡張候補
- フォルダ監視
- モザイク／ぼかし
- 図形（枠・ハイライト）
- 履歴管理
- 目標ファイルサイズ指定
- WebP/JPEG/AVIF対応
- 高度なショートカット操作


